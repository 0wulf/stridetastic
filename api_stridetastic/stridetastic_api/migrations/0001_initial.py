# Generated by Django 5.2.7 on 2025-11-01 14:44

import django.contrib.postgres.fields
import django.db.models.deletion
import django.utils.timezone
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Interface',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(choices=[('MQTT', 'MQTT'), ('SERIAL', 'Serial')], default='MQTT', help_text='Type of the interface (MQTT / SERIAL).', max_length=20)),
                ('display_name', models.CharField(help_text='Unique display name for this interface instance.', max_length=50, unique=True)),
                ('is_enabled', models.BooleanField(default=True, help_text='Whether this interface should be started.')),
                ('status', models.CharField(choices=[('INIT', 'Init'), ('CONNECTING', 'Connecting'), ('RUNNING', 'Running'), ('ERROR', 'Error'), ('STOPPED', 'Stopped')], default='INIT', help_text='Current runtime status of this interface instance.', max_length=15)),
                ('last_connected', models.DateTimeField(blank=True, help_text='Last time the interface successfully connected/started.', null=True)),
                ('last_error', models.TextField(blank=True, help_text='Last runtime error message, if any.', null=True)),
                ('config', models.JSONField(blank=True, help_text='Arbitrary configuration blob.', null=True)),
                ('mqtt_broker_address', models.CharField(blank=True, max_length=255, null=True)),
                ('mqtt_port', models.IntegerField(blank=True, null=True)),
                ('mqtt_topic', models.CharField(blank=True, max_length=255, null=True)),
                ('mqtt_base_topic', models.CharField(blank=True, help_text='Base publish topic override for this interface.', max_length=255, null=True)),
                ('mqtt_username', models.CharField(blank=True, max_length=255, null=True)),
                ('mqtt_password', models.CharField(blank=True, max_length=255, null=True)),
                ('mqtt_tls', models.BooleanField(default=False)),
                ('mqtt_ca_certs', models.CharField(blank=True, max_length=255, null=True)),
                ('serial_port', models.CharField(blank=True, max_length=255, null=True)),
                ('serial_baudrate', models.IntegerField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Interface',
                'verbose_name_plural': 'Interfaces',
                'ordering': ['display_name'],
            },
        ),
        migrations.CreateModel(
            name='NetworkOverviewSnapshot',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('time', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the snapshot was captured.')),
                ('total_nodes', models.PositiveIntegerField(help_text='Total nodes known to the system at capture time.')),
                ('active_nodes', models.PositiveIntegerField(help_text='Nodes seen within the active activity window.')),
                ('reachable_nodes', models.PositiveIntegerField(default=0, help_text='Nodes that responded to the most recent reactive probe cycle.')),
                ('active_connections', models.PositiveIntegerField(help_text='Active edges observed at capture time.')),
                ('channels', models.PositiveIntegerField(help_text='Active channels observed at capture time.')),
                ('avg_battery', models.DecimalField(blank=True, decimal_places=3, help_text='Average battery level percentage across reporting nodes.', max_digits=6, null=True)),
                ('avg_rssi', models.DecimalField(blank=True, decimal_places=3, help_text='Average RSSI value across active edges.', max_digits=6, null=True)),
                ('avg_snr', models.DecimalField(blank=True, decimal_places=3, help_text='Average SNR value across active edges.', max_digits=6, null=True)),
            ],
            options={
                'verbose_name': 'Network Overview Snapshot',
                'verbose_name_plural': 'Network Overview Snapshots',
                'ordering': ['time'],
            },
        ),
        migrations.CreateModel(
            name='CaptureSession',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(help_text='Human readable capture session name.', max_length=128)),
                ('filename', models.CharField(help_text='Name of the generated PCAP file.', max_length=255)),
                ('file_path', models.CharField(help_text='Relative path where the PCAP is stored.', max_length=512)),
                ('file_size', models.BigIntegerField(default=0, help_text='Size of the capture file in bytes.')),
                ('packet_count', models.PositiveIntegerField(default=0, help_text='Number of packets written to the capture.')),
                ('byte_count', models.PositiveBigIntegerField(default=0, help_text='Number of payload bytes written to the capture.')),
                ('status', models.CharField(choices=[('RUNNING', 'Running'), ('COMPLETED', 'Completed'), ('ERROR', 'Error'), ('CANCELLED', 'Cancelled')], default='RUNNING', max_length=16)),
                ('source_type', models.CharField(default='mqtt', help_text='Source type of the capture (mqtt, serial, etc).', max_length=32)),
                ('started_at', models.DateTimeField(default=django.utils.timezone.now, help_text='Timestamp when the capture started.')),
                ('ended_at', models.DateTimeField(blank=True, help_text='Timestamp when the capture ended.', null=True)),
                ('last_packet_at', models.DateTimeField(blank=True, help_text='Timestamp of the most recent packet written.', null=True)),
                ('notes', models.JSONField(blank=True, help_text='Optional metadata about the capture session.', null=True)),
                ('started_by', models.ForeignKey(blank=True, help_text='User that initiated the capture session.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='capture_sessions', to=settings.AUTH_USER_MODEL)),
                ('interface', models.ForeignKey(blank=True, help_text='Optional interface that originated the capture data.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='capture_sessions', to='stridetastic_api.interface')),
            ],
            options={
                'verbose_name': 'Capture Session',
                'verbose_name_plural': 'Capture Sessions',
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='Node',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('node_num', models.BigIntegerField(help_text='Unique number assigned to the node (0-x).', unique=True)),
                ('node_id', models.CharField(help_text='Unique identifier for the node.', max_length=10, unique=True)),
                ('mac_address', models.CharField(help_text='MAC address of the node.', max_length=18, unique=True)),
                ('short_name', models.CharField(blank=True, help_text='Short name of the node.', max_length=4, null=True)),
                ('long_name', models.CharField(blank=True, help_text='Long name of the node.', max_length=32, null=True)),
                ('hw_model', models.CharField(blank=True, help_text='Hardware model of the node.', max_length=32, null=True)),
                ('is_licensed', models.BooleanField(default=False, help_text='Indicates if the node is set as licensed operator.')),
                ('role', models.CharField(blank=True, default='CLIENT', help_text="Role of the node in the network (e.g., 'router', 'client').", max_length=32, null=True)),
                ('public_key', models.CharField(blank=True, help_text='Public key of the node for encryption.', max_length=64, null=True)),
                ('private_key', models.TextField(blank=True, help_text='PEM encoded private key for decrypting PKI messages. Should be stored encrypted at rest once support is added.', null=True)),
                ('private_key_fingerprint', models.CharField(blank=True, help_text='Fingerprint of the stored private key for quick identification.', max_length=128, null=True)),
                ('private_key_updated_at', models.DateTimeField(blank=True, help_text='Timestamp when the private key was last updated.', null=True)),
                ('is_unmessagable', models.BooleanField(default=False, help_text='Indicates if the node is set as unmessagable.')),
                ('is_virtual', models.BooleanField(default=False, help_text='Indicates if the node is managed as a virtual node.')),
                ('latitude', models.DecimalField(blank=True, decimal_places=7, help_text="Latitude of the node's position.", max_digits=10, null=True)),
                ('longitude', models.DecimalField(blank=True, decimal_places=7, help_text="Longitude of the node's position.", max_digits=10, null=True)),
                ('altitude', models.DecimalField(blank=True, decimal_places=2, help_text="Altitude of the node's position in meters.", max_digits=10, null=True)),
                ('position_accuracy', models.DecimalField(blank=True, decimal_places=2, help_text='Accuracy of the position data.', max_digits=10, null=True)),
                ('location_source', models.CharField(blank=True, help_text='Source reported for the most recent position fix.', max_length=32, null=True)),
                ('battery_level', models.IntegerField(blank=True, help_text='Battery level of the device in percentage.', null=True)),
                ('voltage', models.DecimalField(blank=True, decimal_places=2, help_text='Voltage of the device in volts.', max_digits=5, null=True)),
                ('channel_utilization', models.DecimalField(blank=True, decimal_places=2, help_text='Channel utilization of the device in percentage.', max_digits=5, null=True)),
                ('air_util_tx', models.DecimalField(blank=True, decimal_places=2, help_text='Air utilization for transmission of the device in percentage.', max_digits=5, null=True)),
                ('uptime_seconds', models.IntegerField(blank=True, help_text='Uptime of the device in seconds.', null=True)),
                ('temperature', models.DecimalField(blank=True, decimal_places=2, help_text='Temperature in degrees Celsius.', max_digits=5, null=True)),
                ('relative_humidity', models.DecimalField(blank=True, decimal_places=2, help_text='Relative humidity in percentage.', max_digits=5, null=True)),
                ('barometric_pressure', models.DecimalField(blank=True, decimal_places=2, help_text='Barometric pressure in hPa.', max_digits=7, null=True)),
                ('gas_resistance', models.DecimalField(blank=True, decimal_places=2, help_text='Gas resistance in ohms.', max_digits=7, null=True)),
                ('iaq', models.DecimalField(blank=True, decimal_places=2, help_text='Indoor Air Quality (IAQ) index.', max_digits=5, null=True)),
                ('reactive_reachable', models.BooleanField(blank=True, help_text='Indicates whether the most recent reactive traceroute attempt received a response.', null=True)),
                ('reactive_latency_ms', models.PositiveIntegerField(blank=True, help_text='Round-trip latency in milliseconds observed for the most recent reactive traceroute response.', null=True)),
                ('first_seen', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the node was first seen.')),
                ('last_seen', models.DateTimeField(auto_now=True, help_text='Timestamp when the node was last seen.')),
                ('interfaces', models.ManyToManyField(blank=True, help_text='Interfaces where this node has been listened to.', related_name='nodes_listened', to='stridetastic_api.interface')),
            ],
            options={
                'verbose_name': 'Node',
                'verbose_name_plural': 'Nodes',
                'ordering': ['last_seen', 'first_seen'],
            },
        ),
        migrations.CreateModel(
            name='NeighborInfoPayload',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('time', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the neighbor info payload was received.')),
                ('reporting_node_id_text', models.CharField(blank=True, help_text='Node ID string of the reporting node as provided in the payload.', max_length=10, null=True)),
                ('last_sent_by_node_num', models.BigIntegerField(blank=True, help_text='Numeric node identifier supplied in last_sent_by_id when resolvable.', null=True)),
                ('node_broadcast_interval_secs', models.IntegerField(blank=True, help_text='Broadcast interval for the reporting node, if provided (seconds).', null=True)),
                ('last_sent_by_node', models.ForeignKey(blank=True, help_text='Node referenced in last_sent_by_id, if present and resolved.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='neighbor_info_last_sent_reports', to='stridetastic_api.node')),
                ('reporting_node', models.ForeignKey(blank=True, help_text='Database node that reported this neighbor information, if known.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='neighbor_info_reports', to='stridetastic_api.node')),
            ],
            options={
                'verbose_name': 'Neighbor Info Payload',
                'verbose_name_plural': 'Neighbor Info Payloads',
            },
        ),
        migrations.CreateModel(
            name='NeighborInfoNeighbor',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('time', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the neighbor entry was processed.')),
                ('advertised_node_id', models.CharField(blank=True, help_text='Node ID string of the advertised neighbor as provided in the payload.', max_length=10, null=True)),
                ('advertised_node_num', models.BigIntegerField(blank=True, help_text='Numeric node identifier for the neighbor when resolvable.', null=True)),
                ('snr', models.DecimalField(blank=True, decimal_places=2, help_text='Last reported SNR (in dB) for the neighbor link.', max_digits=5, null=True)),
                ('last_rx_time', models.DateTimeField(blank=True, help_text="Timestamp (UTC) corresponding to the neighbor's last_rx_time value, if provided.", null=True)),
                ('last_rx_time_raw', models.BigIntegerField(blank=True, help_text='Raw epoch seconds supplied for last_rx_time, preserved for reference.', null=True)),
                ('node_broadcast_interval_secs', models.IntegerField(blank=True, help_text='Broadcast interval advertised for this neighbor (seconds).', null=True)),
                ('payload', models.ForeignKey(help_text='Parent Neighbor Info payload that reported this neighbor.', on_delete=django.db.models.deletion.CASCADE, related_name='neighbors', to='stridetastic_api.neighborinfopayload')),
                ('node', models.ForeignKey(blank=True, help_text='Resolved node instance for the advertised neighbor, if known.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='advertised_neighbors', to='stridetastic_api.node')),
            ],
            options={
                'verbose_name': 'Neighbor Info Neighbor',
                'verbose_name_plural': 'Neighbor Info Neighbors',
            },
        ),
        migrations.AddField(
            model_name='interface',
            name='serial_node',
            field=models.ForeignKey(blank=True, help_text='Node to bind the serial interface to (if applicable).', null=True, on_delete=django.db.models.deletion.SET_NULL, to='stridetastic_api.node'),
        ),
        migrations.CreateModel(
            name='Channel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('channel_id', models.CharField(default='LongFast', help_text='Name of the channel.', max_length=13)),
                ('channel_num', models.IntegerField(default=0, help_text='Channel Number (0-255).')),
                ('psk', models.CharField(blank=True, help_text='AES encryption key for the channel.', max_length=255, null=True)),
                ('first_seen', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the channel was first seen.')),
                ('last_seen', models.DateTimeField(auto_now=True, help_text='Timestamp when the channel was last seen.')),
                ('interfaces', models.ManyToManyField(help_text='Interfaces this channel belongs to.', related_name='channels', to='stridetastic_api.interface')),
                ('members', models.ManyToManyField(help_text='Nodes that have sent messages to this channel.', related_name='channels', to='stridetastic_api.node')),
            ],
            options={
                'verbose_name': 'Channel',
                'verbose_name_plural': 'Channels',
                'ordering': ['last_seen'],
            },
        ),
        migrations.CreateModel(
            name='NodeReactiveLatencyHistory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('time', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the probe result was recorded.')),
                ('probe_message_id', models.BigIntegerField(blank=True, help_text='Mesh packet identifier associated with this probe when available.', null=True)),
                ('reachable', models.BooleanField(blank=True, help_text='Whether the probe determined the node to be reachable.', null=True)),
                ('latency_ms', models.PositiveIntegerField(blank=True, help_text='Round-trip latency measurement in milliseconds when available.', null=True)),
                ('responded_at', models.DateTimeField(blank=True, help_text='Timestamp when a response was received for this probe.', null=True)),
                ('node', models.ForeignKey(help_text='Node associated with the probe result.', on_delete=django.db.models.deletion.CASCADE, related_name='reactive_latency_history', to='stridetastic_api.node')),
            ],
            options={
                'verbose_name': 'Node Reactive Latency History',
                'verbose_name_plural': 'Node Reactive Latency History',
                'ordering': ['time'],
            },
        ),
        migrations.CreateModel(
            name='Packet',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('time', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the packet was received.')),
                ('raw_data', models.CharField(blank=True, help_text='Raw data of the packet not saved in a specific field.', max_length=512, null=True)),
                ('packet_id', models.BigIntegerField(blank=True, help_text='Identifier for the packet.', null=True)),
                ('rx_time', models.BigIntegerField(blank=True, help_text='Time when the packet was received (secs since 1970).', null=True)),
                ('rx_rssi', models.DecimalField(blank=True, decimal_places=2, help_text='Received Signal Strength Indicator (RSSI) of the packet.', max_digits=5, null=True)),
                ('rx_snr', models.DecimalField(blank=True, decimal_places=2, help_text='Signal-to-Noise Ratio (SNR) of the packet.', max_digits=4, null=True)),
                ('hop_limit', models.IntegerField(blank=True, help_text='Hop limit for the packet.', null=True)),
                ('hop_start', models.IntegerField(blank=True, help_text='Hop start for the packet.', null=True)),
                ('first_hop', models.IntegerField(blank=True, help_text='First hop for the packet.', null=True)),
                ('next_hop', models.IntegerField(blank=True, help_text='Next hop for the packet.', null=True)),
                ('relay_node', models.IntegerField(blank=True, help_text='Node that relayed the packet, if applicable.', null=True)),
                ('want_ack', models.BooleanField(blank=True, help_text='Indicates if an acknowledgment is requested for the packet.', null=True)),
                ('ackd', models.BooleanField(blank=True, help_text='Indicates if the packet has been acknowledged.', null=True)),
                ('priority', models.CharField(blank=True, help_text="Priority of the packet (e.g., 'BACKGROUND', 'ACK').", max_length=32, null=True)),
                ('delayed', models.BooleanField(blank=True, help_text='Indicates if the packet is delayed.', null=True)),
                ('via_mqtt', models.BooleanField(blank=True, help_text='Indicates if the packet was sent via MQTT.', null=True)),
                ('pki_encrypted', models.BooleanField(blank=True, help_text='Indicates if the packet is encrypted using PKI.', null=True)),
                ('public_key', models.CharField(blank=True, help_text='Public key used for encrypting the packet, if applicable.', max_length=255, null=True)),
                ('channels', models.ManyToManyField(help_text='The channels through which the packet was sent.', related_name='packets', to='stridetastic_api.channel')),
                ('from_node', models.ForeignKey(help_text='The node that sent the packet.', on_delete=django.db.models.deletion.CASCADE, related_name='packets_sent', to='stridetastic_api.node')),
                ('gateway_nodes', models.ManyToManyField(blank=True, help_text='The nodes that acted as gateways for the packet, if applicable.', related_name='packets_gatewayed', to='stridetastic_api.node')),
                ('interfaces', models.ManyToManyField(blank=True, help_text='Interfaces where this packet has been listened to.', related_name='packets_listened', to='stridetastic_api.interface')),
                ('to_node', models.ForeignKey(help_text='The node that received the packet.', on_delete=django.db.models.deletion.CASCADE, related_name='packets_received', to='stridetastic_api.node')),
            ],
            options={
                'verbose_name': 'Packet',
                'verbose_name_plural': 'Packets',
                'ordering': ['time'],
            },
        ),
        migrations.CreateModel(
            name='PacketData',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('time', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the packet data was received.')),
                ('portnum', models.IntegerField(blank=True, help_text='Port number of the packet data.', null=True)),
                ('port', models.CharField(blank=True, choices=[('TEXT_MESSAGE_APP', 'Text Message App'), ('POSITION_APP', 'Position'), ('NODEINFO_APP', 'Node Info'), ('NEIGHBORINFO_APP', 'Neighbor Info'), ('TELEMETRY_APP', 'Telemetry'), ('TRACEROUTE_APP', 'Traceroute'), ('ROUTING_APP', 'Routing')], help_text='Port type of the packet data, indicating the type of data contained in the packet.', max_length=32, null=True)),
                ('raw_payload', models.CharField(blank=True, help_text='Raw payload of the packet data not saved in a specific field.', max_length=255, null=True)),
                ('source', models.BigIntegerField(blank=True, help_text='The address of the original sender for this message. This field should _only_ be populated for reliable multihop packets (to keep packets small).', null=True)),
                ('dest', models.BigIntegerField(blank=True, help_text='The address of the destination node. This field is is filled in by the mesh radio device software, application layer software should never need it. RouteDiscovery messages _must_ populate this. Other message types might need to if they are doing multihop routing.', null=True)),
                ('request_id', models.BigIntegerField(blank=True, help_text='Request ID for the packet data. Indicates the original message ID that this message is reporting failure on.', null=True)),
                ('reply_id', models.BigIntegerField(blank=True, help_text='Reply ID for the packet data. Indicates the original message ID that this message is replying to.', null=True)),
                ('want_response', models.BooleanField(blank=True, help_text='Indicates if a response is requested for the packet data.', null=True)),
                ('got_response', models.BooleanField(blank=True, help_text='Indicates if a response has been received for the packet data.', null=True)),
                ('packet', models.OneToOneField(help_text='The packet to which this data protobuf representation belongs. This field is required and must be unique.', on_delete=django.db.models.deletion.CASCADE, related_name='data', to='stridetastic_api.packet')),
            ],
            options={
                'verbose_name': 'Packet Data',
                'verbose_name_plural': 'Packets Data',
                'ordering': ['time'],
            },
        ),
        migrations.CreateModel(
            name='NodeInfoPayload',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('time', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the node info payload was received.')),
                ('short_name', models.CharField(blank=True, help_text='Short name of the node.', max_length=4, null=True)),
                ('long_name', models.CharField(blank=True, help_text='Long name of the node.', max_length=32, null=True)),
                ('hw_model', models.CharField(blank=True, help_text='Hardware model of the node.', max_length=32, null=True)),
                ('is_licensed', models.BooleanField(default=False, help_text='Indicates if the node is set as licensed operator.')),
                ('role', models.CharField(default='CLIENT', help_text="Role of the node in the network (e.g., 'router', 'client').", max_length=32)),
                ('public_key', models.CharField(blank=True, help_text='Public key of the node for encryption.', max_length=255, null=True)),
                ('is_unmessagable', models.BooleanField(default=False, help_text='Indicates if the node is set as unmessagable.')),
                ('packet_data', models.OneToOneField(help_text='The packet data to which this Node Info payload belongs. This field is required and must be unique.', on_delete=django.db.models.deletion.CASCADE, related_name='node_info_payload', to='stridetastic_api.packetdata')),
            ],
            options={
                'verbose_name': 'Node Info Payload',
                'verbose_name_plural': 'Node Info Payloads',
            },
        ),
        migrations.AddField(
            model_name='neighborinfopayload',
            name='packet_data',
            field=models.OneToOneField(help_text='The packet data to which this Neighbor Info payload belongs. This field is required and must be unique.', on_delete=django.db.models.deletion.CASCADE, related_name='neighbor_info_payload', to='stridetastic_api.packetdata'),
        ),
        migrations.CreateModel(
            name='PositionPayload',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('time', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the position payload was received.')),
                ('latitude', models.DecimalField(blank=True, decimal_places=7, help_text="Latitude of the node's position.", max_digits=10, null=True)),
                ('longitude', models.DecimalField(blank=True, decimal_places=7, help_text="Longitude of the node's position.", max_digits=10, null=True)),
                ('altitude', models.IntegerField(blank=True, help_text="Altitude of the node's position in meters.", null=True)),
                ('accuracy', models.IntegerField(blank=True, help_text='Accuracy of the position data.', null=True)),
                ('seq_number', models.IntegerField(blank=True, help_text='Sequence number of the position data.', null=True)),
                ('location_source', models.CharField(blank=True, help_text='Source reported for the position fix (Meshtastic Position.location_source).', max_length=32, null=True)),
                ('packet_data', models.OneToOneField(help_text='The packet data to which this Position payload belongs. This field is required and must be unique.', on_delete=django.db.models.deletion.CASCADE, related_name='position_payload', to='stridetastic_api.packetdata')),
            ],
            options={
                'verbose_name': 'Position Payload',
                'verbose_name_plural': 'Position Payloads',
            },
        ),
        migrations.CreateModel(
            name='RouteDiscoveryRoute',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('time', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the route discovery payload was received.')),
                ('node_list', models.JSONField(blank=True, help_text='List of nodes in the route, represented as a JSON array. This field is optional and can be used to store additional information about the route.', null=True)),
                ('hops', models.IntegerField(blank=True, help_text='Number of hops in the route.', null=True)),
                ('nodes', models.ManyToManyField(help_text='The nodes that are part of this route discovery route. This field is required and can be used to store multiple nodes in the route.', related_name='route_discovery_routes', to='stridetastic_api.node')),
            ],
            options={
                'verbose_name': 'Route Discovery Route',
                'verbose_name_plural': 'Route Discovery Routes',
                'ordering': ['time'],
            },
        ),
        migrations.CreateModel(
            name='RouteDiscoveryPayload',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('time', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the route discovery payload was received.')),
                ('snr_towards', models.JSONField(blank=True, help_text='Signal-to-Noise Ratio (SNR) of the route discovery packet towards the destination, represented as a JSON object. This field is optional and can be used to store additional information about the SNR.', null=True)),
                ('snr_back', models.JSONField(blank=True, help_text='Signal-to-Noise Ratio (SNR) of the route discovery packet back towards the source, represented as a JSON object. This field is optional and can be used to store additional information about the SNR back.', null=True)),
                ('packet_data', models.OneToOneField(help_text='The packet data to which this Route Discovery payload belongs. This field is required and must be unique.', on_delete=django.db.models.deletion.CASCADE, related_name='route_discovery_payload', to='stridetastic_api.packetdata')),
                ('route_back', models.ForeignKey(blank=True, help_text='The route discovery route back associated with this payload. This field is optional and can be used to store additional information about the route discovery back.', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='route_discovery_payloads_back', to='stridetastic_api.routediscoveryroute')),
                ('route_towards', models.ForeignKey(blank=True, help_text='The route discovery route associated with this payload. This field is optional and can be used to store additional information about the route discovery.', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='route_discovery_payloads', to='stridetastic_api.routediscoveryroute')),
            ],
            options={
                'verbose_name': 'Route Discovery Payload',
                'verbose_name_plural': 'Route Discovery Payloads',
                'ordering': ['time'],
            },
        ),
        migrations.CreateModel(
            name='RoutingPayload',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('time', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the route discovery payload was received.')),
                ('error_reason', models.CharField(blank=True, choices=[('NONE', 'None'), ('NO_ROUTE', 'No Route'), ('GOT_NAK', 'Got NAK'), ('NO_INTERFACE', 'No Interface'), ('MAX_RETRANSMIT', 'Max Retransmit'), ('NO_CHANNEL', 'No Channel'), ('TOO_LARGE', 'Too Large'), ('NO_RESPONSE', 'No Response'), ('DUTY_CYCLE_LIMIT', 'Duty Cycle Limit'), ('BAD_REQUEST', 'Bad Request'), ('NOT_AUTHORIZED', 'Not Authorized'), ('PKI_FAILED', 'PKI Failed'), ('PKI_UNKNOWN_PUBKEY', 'PKI Unknown Public Key'), ('ADMIN_BAD_SESSION_KEY', 'Admin Bad Session Key'), ('ADMIN_PUBLIC_KEY_UNAUTHORIZED', 'Admin Public Key Unauthorized')], help_text='Reason for the routing error, if applicable. This field is optional and can be used to store additional information about the routing error.', max_length=32, null=True)),
                ('packet_data', models.OneToOneField(help_text='The packet data to which this Routing payload belongs. This field is required and must be unique.', on_delete=django.db.models.deletion.CASCADE, related_name='routing_payload', to='stridetastic_api.packetdata')),
                ('route_reply', models.OneToOneField(blank=True, help_text='The route discovery payload associated with the route reply. This field is optional and can be used to store additional information about the route reply.', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='route_reply', to='stridetastic_api.routediscoverypayload')),
                ('route_request', models.OneToOneField(blank=True, help_text='The route discovery payload associated with the route request. This field is required and must be unique.', null=True, on_delete=django.db.models.deletion.CASCADE, related_name='route_request', to='stridetastic_api.routediscoverypayload')),
            ],
            options={
                'verbose_name': 'Routing Payload',
                'verbose_name_plural': 'Routing Payloads',
                'ordering': ['time'],
            },
        ),
        migrations.CreateModel(
            name='PublishErserviceConfig',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('singleton_enforcer', models.BooleanField(default=True, editable=False, unique=True)),
                ('enabled', models.BooleanField(default=False)),
                ('from_node', models.CharField(blank=True, default='', max_length=32)),
                ('gateway_node', models.CharField(blank=True, default='', max_length=32)),
                ('channel_key', models.TextField(blank=True, default='')),
                ('hop_limit', models.IntegerField(default=3)),
                ('hop_start', models.IntegerField(default=3)),
                ('want_ack', models.BooleanField(default=False)),
                ('max_tries', models.IntegerField(default=3)),
                ('trigger_ports', django.contrib.postgres.fields.ArrayField(base_field=models.CharField(max_length=64), blank=True, default=list, help_text='Allowed Meshtastic port names that should trigger reactive traceroute injection.', size=None)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('listen_interfaces', models.ManyToManyField(blank=True, help_text='Interfaces that should trigger reactive traceroutes. Leave empty to listen on all.', related_name='reactive_listener_configs', to='stridetastic_api.interface')),
            ],
            options={
                'verbose_name': 'Reactive Publisher Service Configuration',
            },
        ),
        migrations.CreateModel(
            name='TelemetryPayload',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('time', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the telemetry payload was received.')),
                ('battery_level', models.IntegerField(blank=True, help_text='Battery level of the device in percentage.', null=True)),
                ('voltage', models.DecimalField(blank=True, decimal_places=2, help_text='Voltage of the device in volts.', max_digits=5, null=True)),
                ('channel_utilization', models.DecimalField(blank=True, decimal_places=2, help_text='Channel utilization of the device in percentage.', max_digits=5, null=True)),
                ('air_util_tx', models.DecimalField(blank=True, decimal_places=2, help_text='Air utilization for transmission of the device in percentage.', max_digits=5, null=True)),
                ('uptime_seconds', models.IntegerField(blank=True, help_text='Uptime of the device in seconds.', null=True)),
                ('temperature', models.DecimalField(blank=True, decimal_places=2, help_text='Temperature in degrees Celsius.', max_digits=5, null=True)),
                ('relative_humidity', models.DecimalField(blank=True, decimal_places=2, help_text='Relative humidity in percentage.', max_digits=5, null=True)),
                ('barometric_pressure', models.DecimalField(blank=True, decimal_places=2, help_text='Barometric pressure in hPa.', max_digits=7, null=True)),
                ('gas_resistance', models.DecimalField(blank=True, decimal_places=2, help_text='Gas resistance in ohms.', max_digits=7, null=True)),
                ('iaq', models.DecimalField(blank=True, decimal_places=2, help_text='Indoor Air Quality (IAQ) index.', max_digits=5, null=True)),
                ('packet_data', models.OneToOneField(help_text='The packet data to which this Telemetry payload belongs. This field is required and must be unique.', on_delete=django.db.models.deletion.CASCADE, related_name='telemetry_payload', to='stridetastic_api.packetdata')),
            ],
            options={
                'verbose_name': 'Telemetry Payload',
                'verbose_name_plural': 'Telemetry Payloads',
            },
        ),
        migrations.CreateModel(
            name='NodeLink',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('node_a_to_node_b_packets', models.PositiveIntegerField(default=0, help_text='Packets observed flowing from node_a toward node_b.')),
                ('node_b_to_node_a_packets', models.PositiveIntegerField(default=0, help_text='Packets observed flowing from node_b toward node_a.')),
                ('is_bidirectional', models.BooleanField(default=False, help_text='True once packets have been seen in both directions.')),
                ('first_seen', models.DateTimeField(auto_now_add=True, help_text='Timestamp when this logical link was first observed.')),
                ('last_activity', models.DateTimeField(default=django.utils.timezone.now, help_text='Timestamp when communication was most recently observed on this link.')),
                ('channels', models.ManyToManyField(blank=True, help_text='Channels that have carried traffic for this logical link.', related_name='logical_links', to='stridetastic_api.channel')),
                ('node_a', models.ForeignKey(help_text='Canonical first node of the logical link.', on_delete=django.db.models.deletion.CASCADE, related_name='links_as_node_a', to='stridetastic_api.node')),
                ('node_b', models.ForeignKey(help_text='Canonical second node of the logical link.', on_delete=django.db.models.deletion.CASCADE, related_name='links_as_node_b', to='stridetastic_api.node')),
                ('last_packet', models.ForeignKey(blank=True, help_text='Most recent packet associated with this link.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='logical_links', to='stridetastic_api.packet')),
            ],
            options={
                'ordering': ['-last_activity', '-first_seen'],
                'indexes': [models.Index(fields=['last_activity'], name='stridetastic_last_ac_f5caa6_idx'), models.Index(fields=['is_bidirectional'], name='stridetastic_is_bidi_bcaca7_idx')],
                'constraints': [models.UniqueConstraint(fields=('node_a', 'node_b'), name='unique_logical_link_pair')],
            },
        ),
        migrations.CreateModel(
            name='Edge',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('first_seen', models.DateTimeField(auto_now_add=True, help_text='Timestamp when the edge was first seen.')),
                ('last_seen', models.DateTimeField(auto_now=True, help_text='Timestamp when the edge was last seen.')),
                ('last_rx_rssi', models.IntegerField(blank=True, help_text='Last received RSSI for the edge.', null=True)),
                ('last_rx_snr', models.DecimalField(blank=True, decimal_places=2, help_text='Last received SNR for the edge.', max_digits=5, null=True)),
                ('last_hops', models.IntegerField(default=0, help_text='Last number of hops for the edge.')),
                ('interfaces', models.ManyToManyField(help_text='Interfaces through which this edge is observed.', related_name='edges', to='stridetastic_api.interface')),
                ('source_node', models.ForeignKey(help_text='Source node of the edge.', on_delete=django.db.models.deletion.CASCADE, related_name='source_edges', to='stridetastic_api.node')),
                ('target_node', models.ForeignKey(help_text='Target node of the edge.', on_delete=django.db.models.deletion.CASCADE, related_name='target_edges', to='stridetastic_api.node')),
                ('last_packet', models.ForeignKey(blank=True, help_text='Last packet associated with this edge.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='last_packet_edge', to='stridetastic_api.packet')),
            ],
            options={
                'unique_together': {('source_node', 'target_node')},
            },
        ),
    ]
